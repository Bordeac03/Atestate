<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
    *, ::before, ::after {
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
    }

    body {
      display: flex;
      background-color: rgba(129, 164, 219,0.5);
    }

    .loader {
      position: relative;
      width: 80px;
      height: 80px;
      transform: rotate(165deg);
      position: absolute;
      top: calc(50% + 20px);
      left: calc(50% - 40px);
      z-index: 1;
    }
    .loader:before,
    .loader:after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      display: block;
      width: 16px;
      height: 16px;
      border-radius: 8px;
      transform: translate(-50%, -50%);
    }

    .loader:before {
      animation: before 2s infinite;
    }

    .loader:after {
      animation: after 2s infinite;
    }

    @keyframes before {
      0% {
        width: 16px;
        box-shadow: 32px -16px rgba(225, 20, 98, 1),
          -32px 16px rgba(111, 202, 220, 1);
      }

      35% {
        width: 80px;
        box-shadow: 0px -16px rgba(225, 20, 98, 1),
          0px 16px rgba(111, 202, 220, 1);
      }

      70% {
        width: 16px;
        box-shadow: -32px -16px rgba(225, 20, 98, 1),
          32px 16px rgba(111, 202, 220, 1);
      }

      100% {
        width: 16px;
        box-shadow: 32px -16px rgba(225, 20, 98, 1),
          -32px 16px rgba(111, 202, 220, 1);
      }
    }

    @keyframes after {
      0% {
        height: 16px;
        box-shadow: 16px 32px rgba(61, 184, 143, 1),
          -16px -32px rgba(233, 169, 32, 1);
      }

      35% {
        height: 80px;
        box-shadow: 16px 0px rgba(61, 184, 143, 1),
          -16px 0px rgba(233, 169, 32, 1);
      }

      70% {
        height: 32px;
        box-shadow: 16px -32px rgba(61, 184, 143, 1),
          -16px 32px rgba(233, 169, 32, 1);
      }

      100% {
        box-shadow: 16px 32px rgba(61, 184, 143, 1),
          -16px -32px rgba(233, 169, 32, 1);
      }
    }

    .box {
      left: 25%;
      top: 200px;
      width: 50%;
      height: 400px;
      background-color: white;
      padding: 10px;
      border-style: solid;
      border-width: 1px;
      border-color: black;
      position: absolute;

    }
    .title {
      text-align: center;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 200%;
    }
    .input, .label {
      width : 50%;
      padding: 10px;
      margin: 5px;
      font-size: 130%;
    }
    .label {
      font-family: Arial, Helvetica, sans-serif;
      width: 40%;
      display:inline-block;
    }
    .modal {
      display: none; 
      position: fixed;
      z-index: 1; 
      left: 0;
      top: 0;
      width: 100%; 
      height: 100%;
      overflow: auto; 
      background-color: rgb(0,0,0); 
      background-color: rgba(0,0,0,0.4); 
    }

    .modal-content {
      background-color: #fefefe;
      margin: 15% auto; 
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,19);
      animation-name: animatetop;
      animation-duration: 0.6s
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    @-webkit-keyframes animatetop {
      from {top:-300px; opacity:0} 
      to {top:0; opacity:1}
    }

    @keyframes animatetop {
      from {top:-300px; opacity:0}
      to {top:0; opacity:1}
    }
    .all {
      background-color: rgb(209, 132, 132);
      color: black;
      font-size: 20px;
      padding: 16px;
      border-radius: 8px;
      border: none;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      position: absolute;
      right: 300px;
      bottom: 5px;
      outline: none;
    }
    .all:active {
      background-color: rgb(214, 139, 139);
      transform: translateY(2.5px) translateX(2.5px);
    }
    table{
      font-family: Arial, Helvetica, sans-serif;
      border-collapse: collapse;
      width: 100%;
    }
    td,th {
      border: 1px solid #ddd;
      padding: 8px;
    }
    tr:nth-child(even){background-color: #f2f2f2;}
    tr:hover {background-color: #ddd;}
    th {
      padding-top: 12px;
      padding-bottom: 12px;
      text-align: left;
      background-color: #ff8040;
      color: white;
    }
    .delete {
      padding: 16px;
      font-size: 16px;
      background-color: gray;
      color: black;
      border: none;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      border-radius: 8px;
      outline: none;
    }
    .delete:active {
      background-color: #272727;
      transform: translateY(5px);
    }
    .add {
      background-color: rgb(209, 132, 132);
      color: black;
      font-size: 20px;
      padding: 16px;
      border-radius: 8px;
      border: none;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      position: absolute;
      left: 300px;
      bottom: 5px;
      outline: none;
    }
    .add:active {
      background-color: rgb(214, 139, 139);
      transform: translateY(2.5px) translateX(2.5px);
    }
    </style>
  </head>
  <body>
    <div class="loader"></div>
    <div class="box" id="content">
      <h3 class="title">ATESTAT SRL</h3>
      <label class="label">Nume:</label>
      <input id="nume" class="input" type="text" onchange="check()">
      <label class="label">Prenume:</label>
      <input id="prenume"class="input" type="text" onchange="check()">
      <button class="all" onclick="ALL()">ALL</button>
      <button class="add" onclick="ADD()">ADD</button>
    </div>
    <div id="mod" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <table id="tabel">
          <tr>
            <th>Nume</th>
            <th>Prenume</th>
            <th>CNP</th>
            <th>Data Nasterii</th>
            <th>Salariu(Euro)</th>
            <th>Specializare</th>
          </tr>
        </table>
      </div>
    </div>
    <div id="modAdd" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <label class="label">Nume:</label>
        <input id="nume2" class="input" type="text" onchange="AD()">
        <label class="label">Prenume:</label>
        <input id="prenume2" class="input" type="text" onchange="AD()">
        <label class="label">CNP:</label>
        <input id="cnp2" class="input" type="text" onchange="AD()">
        <label class="label">Data Nasterii:</label>
        <input id="datan2" class="input" type="date" onchange="AD()">
        <label class="label">Salariu:</label>
        <input id="salariu2" class="input" type="text" onchange="AD()">
        <label class="label">Functie:</label>
        <input id="functie2" class="input" type="text" onchange="AD()">
      </div>
    </div>
    <script>
      function ADD() {
        var modal = document.getElementById("modAdd");
        var span = document.getElementsByClassName("close")[1];
        modal.style.display = "block";
        span.onclick = function() {
          modal.style.display = "none";
        }
        window.onclick = function(event) {
          if (event.target == modal) {
            modal.style.display = "none";
          }
        }  
      }
      function AD() {
        var nume = document.getElementById("nume2").value.trim();
        var prenume = document.getElementById("prenume2").value.trim();
        var cnp = document.getElementById("cnp2").value.trim();
        var datan = document.getElementById("datan2").value.trim();
        var salariu = document.getElementById("salariu2").value.trim();
        var functie = document.getElementById("functie2").value.trim(); 
        
        if(nume != "" && prenume != "" && cnp != "" && cnp.match(/^[0-9]+$/) != null && cnp.length == 13 && datan != "" && salariu != "" && functie != "") {
          if(confirm("Adaugati salariat?")){
            var sql = new XMLHttpRequest();
              sql.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                  console.log(this.responseText);
                  var modal = document.getElementById("modAdd");
                  modal.style.display = "none";
                }
              }
              sql.open("POST", "/php/save.php", true);
              sql.setRequestHeader("Content-type", "application/application/json");
              sql.send(JSON.stringify({nume:nume, prenume:prenume,cnp:cnp,datan:datan,salariu:salariu,functie:functie}));  
          }
        }
      }
      function ALL() {
        var modal = document.getElementById("mod");
        var span = document.getElementsByClassName("close")[0];
        var tabel = document.getElementById("tabel");
        modal.style.display = "block";
        span.onclick = function() {
        modal.style.display = "none";
          while(1 < tabel.rows.length)
            tabel.deleteRow(1);

      }
      window.onclick = function(event) {
        if (event.target == modal) {
          modal.style.display = "none";
          
          while(1 < tabel.rows.length)
            tabel.deleteRow(1);
        }
      }
        var check = new XMLHttpRequest();
          check.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
              console.log(this.responseText);
              if(this.responseText != "NULL") {
                var all = JSON.parse(this.responseText);
                while(1 < tabel.rows.length)
                      tabel.deleteRow(1);
                for(var i = 0; i < all.length; i++){
                  var tr = document.createElement("tr");
                  var td = document.createElement("td");
                  td.innerHTML= all[i].Nume;
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i].Prenume;
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i].CNP;
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i].Data_Nasterii;
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i]['Salariu(Euro)'];
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i].Specializare;
                  tr.appendChild(td);
                  td = document.createElement('td');
                  del = document.createElement('button');
                  del.innerHTML = "Eliminare";
                  del.setAttribute("class","delete");
                  del.setAttribute("id",all[i].ID);
                  del.onclick = function() {
                    var request = new XMLHttpRequest();
                    request.onreadystatechange = function() {
                      if (this.readyState == 4 && this.status == 200) {
                        console.log(this.responseText);
                        ALL();
                      }  
                    }
                    request.open("POST", "/php/stergere.php", true);
                    request.setRequestHeader("Content-type", "application/application/json");
                    request.send(JSON.stringify({ID:this.id}));  
                  }
                  td.appendChild(del);
                  tr.appendChild(td);
                  tabel.appendChild(tr);
                }
                
                }   
              }
            }  
          check.open("POST", "/php/check.php", true);
          check.setRequestHeader("Content-type", "application/application/json");
          check.send(JSON.stringify({nume:'ALL', prenume:'ALL'}));  
      }
      function check() {
        var nume = document.getElementById("nume").value.trim();
        var prenume = document.getElementById("prenume").value.trim();
        
        if(nume != "" && prenume != ""){
          var check = new XMLHttpRequest();
          check.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
              console.log(this.responseText);
              if(this.responseText != "NULL") {
                var modal = document.getElementById("mod");
                var span = document.getElementsByClassName("close")[0];
                var tabel = document.getElementById("tabel");
                var all = JSON.parse(this.responseText);

                for(var i = 0; i < all.length; i++){
                  var tr = document.createElement("tr");
                  var td = document.createElement("td");
                  td.innerHTML= all[i].Nume;
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i].Prenume;
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i].CNP;
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i].Data_Nasterii;
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i]['Salariu(Euro)'];
                  tr.appendChild(td);
                  td = document.createElement("td");
                  td.innerHTML= all[i].Specializare;
                  tr.appendChild(td);
                  tabel.appendChild(tr);
                }
                modal.style.display = "block";
                span.onclick = function() {
                  modal.style.display = "none";
                    while(1 < tabel.rows.length)
                      tabel.deleteRow(1);

                }
                window.onclick = function(event) {
                  if (event.target == modal) {
                    modal.style.display = "none";
                    
                    while(1 < tabel.rows.length)
                      tabel.deleteRow(1);
                  }
                }   
              }
            }  
          }
          check.open("POST", "/php/check.php", true);
          check.setRequestHeader("Content-type", "application/application/json");
          check.send(JSON.stringify({nume:nume, prenume:prenume}));  
        }
      }
    </script>
  </body>
</html>